# DispaExtractor

Набор инструментов для извлечения и обработки персональных данных пациентов из медицинских архивов.

## Компоненты проекта

### 1. extract_personal_data_from_xlsx.py
**Извлечение полных данных пациентов из Excel файлов**

Сканирует файлы "Персональные данные.xlsx" и извлекает:
- СНИЛС (ячейка B1)
- ФИО (ячейка B2) 
- Дата рождения (ячейка B3)

Результат: `СНИЛС ФИО Дата_рождения`

### 2. extract_snils_surnames.py
**Универсальный сборщик СНИЛС и фамилий**

Извлекает пары СНИЛС + фамилия из:
- Структуры каталогов (папки с именами-СНИЛС)
- Имен файлов (кириллические фамилии)
- Excel файлов "Персональные данные.xlsx"

Исключает медицинские термины и создает дедуплицированный список.

### 3. data_converter.html
**Веб-интерфейс для проверки данных через ФЕРЗ**

- Конвертирование различных форматов данных в таблицу
- Проверка пациентов через сервис ФЕРЗ
- Поиск дубликатов
- Экспорт в Excel
- Поддержка СНИЛС, ЕНП, паспортов РФ

## Быстрый старт

### Установка зависимостей
```bash
pip install -r requirements.txt
```

### Использование скриптов

#### Извлечение полных данных из Excel
```bash
python scripts/extract_personal_data_from_xlsx.py
```
Результат: `scripts/personal_data.txt`

#### Универсальное извлечение СНИЛС + фамилий
```bash
python scripts/extract_snils_surnames.py
```
Результат: `scripts/snils_surnames.txt`

#### Веб-интерфейс
Откройте `data_converter.html` в браузере для:
- Проверки данных через ФЕРЗ
- Поиска дубликатов
- Экспорта в Excel

## Форматы данных

### Поддерживаемые входные форматы
- **СНИЛС**: 11 цифр (123-456-789 01 или 12345678901)
- **ЕНП**: 16 цифр  
- **Паспорт РФ**: 10 цифр (серия + номер)
- **Строки**: `документ фамилия` через пробел, запятую или точку с запятой 
ИЛИ 
`Номер_документа(СНИЛС, ЕНС, ДУЛ) Фамилия Имя Отчество Дата_рождения`

### Примеры выходных данных

**extract_personal_data_from_xlsx.py:**
```
14183634157 Иванов Иван Иванович 04.10.2002
02917302211 Сидоров Петр Иванович 15.10.1972
```

**extract_snils_surnames.py:**
```
14384234157 Иванов
00917302221 Петров
01082697228 Сидоров
02217279110
```

## Требования

- Python 3.6+
- openpyxl (для работы с Excel)