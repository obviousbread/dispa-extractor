# DISPA - СНИЛС и Фамилии Extractor

Утилита для извлечения пар СНИЛС + Фамилия из структуры каталогов с файлами.

## Описание

Этот инструмент сканирует структуру каталогов и извлекает пары "СНИЛС + Фамилия" из:
- Имен файлов (первое кириллическое слово, похожее на фамилию)
- Excel файлов с именем "Персональные данные.xlsx" (ячейка B2, первое слово как фамилия)

## Особенности

- **Обнаружение СНИЛС**: Поиск 11-значных номеров в путях файлов или именах файлов
- **Извлечение фамилий**: Умное определение фамилий из кириллических слов
- **Поддержка Excel**: Чтение ячейки B2 из файлов "Персональные данные.xlsx"
- **Дедупликация**: Автоматическое удаление дубликатов
- **Сортировка**: Результаты отсортированы по СНИЛС, затем по фамилии

## Установка

1. Клонировать репозиторий:
```bash
git clone <repository-url>
cd dispa
```

2. Установить зависимости:
```bash
pip install -r requirements.txt
```

## Использование

### Базовое использование

```bash
python scripts/extract_snils_surnames.py
```

Сканирует текущий каталог и создает файлы:
- `all_paths.txt` - список всех найденных файлов
- `snils_surnames.txt` - пары СНИЛС + Фамилия

### Расширенное использование

```bash
python scripts/extract_snils_surnames.py /path/to/scan --paths custom_paths.txt --out custom_results.txt
```

### Параметры командной строки

- `ROOT_DIR` - Корневой каталог для сканирования (по умолчанию: текущий каталог)
- `--paths OUT1` - Файл для списка всех путей (по умолчанию: `all_paths.txt`)
- `--out OUT2` - Файл для результатов СНИЛС+Фамилия (по умолчанию: `snils_surnames.txt`)

## Формат вывода

Файл результатов содержит по одной паре на строку:
```
00899112570 Жукова
00899112570 Шмаль
05327487162 Карасева
```

## Алгоритм извлечения фамилий

1. **Из имен файлов**:
   - Поиск первого кириллического слова, за которым следует другое имя или инициалы
   - Предпочтение словам в ВЕРХНЕМ РЕГИСТРЕ или с Заглавной буквой
   - Минимальная длина: 3 символа

2. **Из Excel файлов**:
   - Чтение ячейки B2 из файлов "Персональные данные.xlsx"
   - Извлечение первого слова как фамилии

## Требования

- Python 3.6+
- openpyxl (для работы с Excel файлами)

## Примеры структуры файлов

Скрипт может обрабатывать такие структуры:
```
/data/
  12345678901/
    Иванов_И_И_документ.pdf
    Персональные данные.xlsx
  98765432109/
    ПЕТРОВА_А_В_справка.docx
```

Результат:
```
12345678901 Иванов
98765432109 Петрова
```

## Замечания

- Если библиотека `openpyxl` не установлена, извлечение из Excel файлов будет пропущено
- СНИЛС определяется как последовательность из ровно 11 цифр
- Поддерживаются файлы с расширениями .xlsx и .xslx (учитывая возможные опечатки)

## Лицензия

Этот проект распространяется под лицензией MIT.